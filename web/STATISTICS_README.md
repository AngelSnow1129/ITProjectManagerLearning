# 访问统计功能说明

## 📊 功能概述

本项目已集成访问统计功能，可以追踪学习平台的使用情况。

### 统计指标

1. **🔥 热度（总访问量）**
   - 记录所有页面访问次数
   - 每次刷新页面都会增加计数
   - 反映平台的整体活跃度

2. **👁️ 关注度（唯一访客数）**
   - 基于浏览器指纹识别唯一访客
   - 同一设备/浏览器只计数一次
   - 反映实际使用人数

## 🔧 技术实现

### 浏览器指纹识别

使用以下信息生成唯一标识：
- Canvas指纹
- 屏幕分辨率
- 时区
- 语言设置
- 操作系统平台

### 数据存储

- 使用 `localStorage` 存储统计数据
- 使用 `sessionStorage` 防止同一会话重复计数
- 数据完全存储在本地，不上传服务器

## 📁 文件说明

### statistics.js
核心统计功能文件，包含：
- `VisitStatistics` 类：统计功能主类
- `getCurrentYear()` 函数：获取当前年份
- `updateCopyrightYear()` 函数：自动更新版权年份

### 已修改的HTML文件
所有主要页面都已集成统计功能：
- `index.html` - 主页
- `nav.html` - 导航页
- `viewer.html` - 文档查看器
- `chapters.html` - 章节列表
- `resources.html` - 资源页
- `study.html` - 学习页
- `file-browser.html` - 文件浏览器
- `offline-viewer.html` - 离线查看器

### stats-demo.html
统计功能演示页面，提供：
- 实时统计数据显示
- 刷新统计功能
- 重置数据功能
- 功能说明

## 🚀 使用方法

### 查看统计数据

1. 访问任意页面，统计会自动记录
2. 在页面底部可以看到热度和关注度显示
3. 访问 `stats-demo.html` 查看详细统计

### 测试统计功能

```bash
# 启动本地服务器
python -m http.server 8000

# 访问演示页面
http://localhost:8000/web/stats-demo.html
```

### 重置统计数据

方法1：在演示页面点击"重置数据"按钮

方法2：在浏览器控制台执行：
```javascript
visitStats.resetStats();
```

方法3：清除浏览器的 localStorage 数据

## 💡 特性说明

### 会话管理
- 每个浏览器会话只计数一次
- 关闭浏览器后重新打开会再次计数
- 刷新页面不会重复计数（同一会话内）

### 数据持久化
- 数据存储在浏览器本地
- 不依赖服务器
- 清除浏览器数据会重置统计

### 隐私保护
- 不收集个人信息
- 不上传任何数据
- 完全本地化运行

## 🎨 显示样式

统计信息显示格式：
```
🔥 热度: 1.2k    👁️ 关注度: 156
```

数字格式化规则：
- 小于 1000：显示原数字
- 1000-9999：显示为 "1.0k" 格式
- 10000+：显示为 "1.0w" 格式

## 📅 动态年份

所有页面的版权年份会自动更新为当前年份：
```html
© 2024 → © 2025 (自动更新)
```

## 🔍 调试方法

在浏览器控制台查看统计数据：
```javascript
// 查看当前统计
visitStats.getStats();

// 查看存储的指纹列表
visitStats.getIPs();

// 手动记录访问
visitStats.recordVisit();

// 重置统计
visitStats.resetStats();
```

## ⚠️ 注意事项

1. 统计数据存储在浏览器本地，不同浏览器数据独立
2. 清除浏览器缓存会导致统计数据丢失
3. 隐私模式/无痕模式下的访问不会被持久化记录
4. 如需服务器端统计，需要额外开发后端接口

## 🔄 更新日志

### v1.0.0 (2024-12-22)
- ✅ 实现热度统计（总访问量）
- ✅ 实现关注度统计（唯一访客）
- ✅ 基于浏览器指纹的访客识别
- ✅ 动态年份显示
- ✅ 统计数据本地存储
- ✅ 会话管理防止重复计数
- ✅ 创建统计演示页面

## 📞 技术支持

如有问题或建议，请通过以下方式反馈：
- GitHub Issues
- Pull Requests

---

**祝您学习愉快！** 🎓
